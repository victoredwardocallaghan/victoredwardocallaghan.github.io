<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <title>Cryptol 2 Language Primitives - alt.folklore.things</title>
  <meta name="author" content="Edward O'Callaghan">
  <meta name="description" content="funfunctor">

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="/favicon.png" rel="shortcut icon">
  <link href='http://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Merriweather:900italic,900,700italic,400italic,700,400,300italic,300' rel='stylesheet' type='text/css'>
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <link href='/css/screen.css' rel='stylesheet' type='text/css' media='screen' />
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml" />
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src='/js/blaenk.js' type='text/javascript'></script>
</head>
<body>
  <div class="wrapper">
    <header id="header" class="inner">
      <div id="stamp">
        <h1><a href="/">alt.folklore.things</a></h1>
        <h4>Will this Eternal September ever end..</h4>
      </div>
      <nav id="main-nav">
        <ul class="main">
          <li><a href="/posts/">Posts</a></li>
          <li><a href="/notes/">Notes</a></li>
          <li><a href="/research/">Research</a></li>
          <li><a href="/about/">About</a></li>
          <li><a id="search_btn">Search</a></li>
        </ul>
      </nav>
      <nav id="mobile-nav">
        <div class="alignleft menu">
          <a class="button">Menu</a>
          <div class="container">
            <ul class="main">
              <li><a href="/posts/">Posts</a></li>
              <li><a href="/notes/">Notes</a></li>
              <li><a href="/research/">Research</a></li>
              <li><a href="/about/">About</a></li>
              <li><a id="search_btn">Search</a></li>
            </ul>
          </div>
        </div>
        <div class="alignright search">
          <a class="button"></a>
          <div class="container">
            <form action="http://google.com/search" method="get">
              <input type="text" name="q" results="0">
              <input type="hidden" name="q" value="site:alterapraxis.com">
            </form>
          </div>
        </div>
      </nav>
    </header>
    <div id="content" class="inner">
      <form class="desk_search" action="http://google.com/search" method="get">
        <input id="search" type="text" name="q" results="0" placeholder="Search" autocomplete="off" spellcheck="false">
        <input type="hidden" name="q" value="site:blaenkdenum.com">
      </form>
      <article class="post">
  <h2 class="title"><a href="/notes/cryptol-primitives/"><span>Cryptol 2 Language Primitives</span></a></h2>
  <div class="entry-content"><nav id="toc" class="right-toc"><p>Contents</p><ol><li><a href="#cryptol-2-language-primitives">Cryptol 2 Language Primitives</a><ol><li><a href="#comparisons-and-ordering">Comparisons and Ordering</a></li><li><a href="#arithmetic">Arithmetic</a></li><li><a href="#boolean">Boolean</a></li><li><a href="#sequences">Sequences</a></li><li><a href="#shift-and-rotate">Shift And Rotate</a></li><li><a href="#random-values">Random Values</a></li><li><a href="#debugging">Debugging</a></li><li><a href="#hints-for-hardware-generation">Hints for Hardware Generation?</a></li><li><a href="#closing-remarks">Closing Remarks</a></li></ol></li></ol></nav>
<h1 id="cryptol-2-language-primitives">Cryptol 2 Language Primitives</h1>
<p>Cryptol 2 has a number of built-in primitive functions. Herein we summaries them.</p>
<hr />
<h2 id="comparisons-and-ordering">Comparisons and Ordering</h2>
<figure class="codeblock"><pre><code class="highlight language-haskell"> <span class="p">(</span><span class="o">==</span><span class="p">)</span>   <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">}</span>   <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Bit</span>
 <span class="p">(</span><span class="o">!=</span><span class="p">)</span>   <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">}</span>   <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Bit</span>
 <span class="p">(</span><span class="o">===</span><span class="p">)</span>  <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">}</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">b</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Bit</span>
 <span class="p">(</span><span class="o">!==</span><span class="p">)</span>  <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">}</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">b</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Bit</span>

 <span class="p">(</span><span class="o">&lt;</span><span class="p">)</span>    <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Bit</span>
 <span class="p">(</span><span class="o">&gt;</span><span class="p">)</span>    <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Bit</span>
 <span class="p">(</span><span class="o">&lt;=</span><span class="p">)</span>   <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Bit</span>
 <span class="p">(</span><span class="o">&gt;=</span><span class="p">)</span>   <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Bit</span>

 <span class="n">min</span>    <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="n">max</span>    <span class="kt">:</span>  <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>

 <span class="kr">instance</span> <span class="kt">Cmp</span> <span class="kt">Bit</span>
 <span class="o">//</span> <span class="kt">No</span> <span class="kr">instance</span> <span class="n">for</span> <span class="n">functions</span><span class="o">.</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">,</span> <span class="n">fin</span> <span class="n">n</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Cmp</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="n">a</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Cmp</span> <span class="n">b</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Cmp</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="kt">Cmp</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Cmp</span> <span class="n">b</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Cmp</span> <span class="p">{</span> <span class="n">x</span> <span class="kt">:</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span> <span class="kt">:</span> <span class="n">b</span> <span class="p">}</span>
</code></pre></figure>
<h2 id="arithmetic">Arithmetic</h2>
<figure class="codeblock"><pre><code class="highlight language-haskell"> <span class="n">negate</span> <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">+</span><span class="p">)</span>    <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">-</span><span class="p">)</span>    <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">*</span><span class="p">)</span>    <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">/</span><span class="p">)</span>    <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">%</span><span class="p">)</span>    <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">^^</span><span class="p">)</span>   <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>

 <span class="o">//</span> <span class="kt">No</span> <span class="kr">instance</span> <span class="n">for</span> <span class="p">`</span><span class="kt">Bit</span><span class="p">`</span><span class="o">.</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="n">fin</span> <span class="n">n</span><span class="p">)</span>            <span class="ow">=&gt;</span> <span class="kt">Arith</span> <span class="p">(</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="kt">Bit</span><span class="p">)</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">)</span>          <span class="ow">=&gt;</span> <span class="kt">Arith</span> <span class="p">(</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="n">a</span><span class="p">)</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">b</span><span class="p">)</span>          <span class="ow">=&gt;</span> <span class="kt">Arith</span> <span class="p">(</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span><span class="p">)</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Arith</span> <span class="n">b</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Arith</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="kt">Arith</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Arith</span> <span class="n">b</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Arith</span> <span class="p">{</span> <span class="n">x</span> <span class="kt">:</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span> <span class="kt">:</span> <span class="n">b</span> <span class="p">}</span>
</code></pre></figure>
<p>Note that because there is no instances for <code>Arith Bit</code> the top two instances do not actually overlap.</p>
<p>A corner case: unlike the old system, weâ€™d also have to define <code>negate</code> at type <code>0</code>. This makes sense, there is only one element of type <code>[0]</code>, so it is naturally its own inverse, thus <code>negate</code> should behave as the identity function.</p>
<h2 id="boolean">Boolean</h2>
<figure class="codeblock"><pre><code class="highlight language-haskell"> <span class="kt">False</span> <span class="kt">:</span> <span class="kt">Bit</span>
 <span class="kt">True</span>  <span class="kt">:</span> <span class="kt">Bit</span>

 <span class="n">zero</span>  <span class="kt">:</span> <span class="p">(</span><span class="kt">Logic</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">&amp;&amp;</span><span class="p">)</span>  <span class="kt">:</span> <span class="p">(</span><span class="kt">Logic</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">||</span><span class="p">)</span>  <span class="kt">:</span> <span class="p">(</span><span class="kt">Logic</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">^</span><span class="p">)</span>   <span class="kt">:</span> <span class="p">(</span><span class="kt">Logic</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">~</span><span class="p">)</span>   <span class="kt">:</span> <span class="p">(</span><span class="kt">Logic</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>

 <span class="o">//</span> <span class="kt">There</span> <span class="n">are</span> <span class="n">instances</span> <span class="n">for</span> <span class="n">all</span> <span class="n">types</span><span class="p">,</span>
 <span class="o">//</span> <span class="n">so</span> <span class="n">we</span> <span class="n">could</span> <span class="n">potentially</span> <span class="n">omit</span> <span class="n">the</span> <span class="n">constraints</span><span class="o">.</span>
 <span class="kr">instance</span> <span class="kt">Logic</span> <span class="kt">Bit</span>
 <span class="kr">instance</span> <span class="kt">Logic</span> <span class="n">a</span>            <span class="ow">=&gt;</span> <span class="kt">Logic</span> <span class="p">([</span><span class="n">n</span><span class="p">]</span> <span class="n">a</span><span class="p">)</span>
 <span class="kr">instance</span> <span class="kt">Logic</span> <span class="n">b</span>            <span class="ow">=&gt;</span> <span class="kt">Logic</span> <span class="p">(</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span><span class="p">)</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="kt">Logic</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Logic</span> <span class="n">b</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Logic</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
 <span class="kr">instance</span> <span class="p">(</span><span class="kt">Logic</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Logic</span> <span class="n">b</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Logic</span> <span class="p">{</span> <span class="n">x</span> <span class="kt">:</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span> <span class="kt">:</span> <span class="n">b</span> <span class="p">}</span>
</code></pre></figure>
<h2 id="sequences">Sequences</h2>
<figure class="codeblock"><pre><code class="highlight language-haskell"> <span class="n">length</span>    <span class="kt">:</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">}</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;=</span> <span class="n">width</span> <span class="n">n</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span>

 <span class="n">join</span>      <span class="kt">:</span> <span class="p">{</span><span class="n">parts</span><span class="p">,</span><span class="n">ench</span><span class="p">,</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">each</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">parts</span><span class="p">][</span><span class="n">each</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">parts</span> <span class="o">*</span> <span class="n">each</span><span class="p">]</span><span class="n">a</span>
 <span class="n">split</span>     <span class="kt">:</span> <span class="p">{</span><span class="n">parts</span><span class="p">,</span><span class="n">each</span><span class="p">,</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">each</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">parts</span> <span class="o">*</span> <span class="n">each</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">parts</span><span class="p">][</span><span class="n">each</span><span class="p">]</span><span class="n">a</span>

 <span class="p">(</span><span class="o">#</span><span class="p">)</span>       <span class="kt">:</span> <span class="p">{</span><span class="n">front</span><span class="p">,</span><span class="n">back</span><span class="p">,</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">front</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">front</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">back</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">front</span> <span class="o">+</span> <span class="n">back</span><span class="p">]</span><span class="n">a</span>
 <span class="n">splitAt</span>   <span class="kt">:</span> <span class="p">{</span><span class="n">front</span><span class="p">,</span><span class="n">back</span><span class="p">,</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">front</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">from</span> <span class="o">+</span> <span class="n">back</span><span class="p">]</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">([</span><span class="n">front</span><span class="p">]</span> <span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="n">back</span><span class="p">]</span> <span class="n">a</span><span class="p">)</span>

 <span class="n">reverse</span>   <span class="kt">:</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">n</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span>
 <span class="n">transpose</span> <span class="kt">:</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">a</span><span class="p">}</span> <span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">m</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="n">a</span>

 <span class="p">(</span><span class="o">@</span><span class="p">)</span>        <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span> <span class="n">m</span><span class="p">}</span>              <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span>    <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">@@</span><span class="p">)</span>       <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span> <span class="n">m</span> <span class="n">i</span><span class="p">}</span>            <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="n">a</span>
 <span class="p">(</span><span class="o">!</span><span class="p">)</span>        <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span> <span class="n">m</span><span class="p">}</span>   <span class="p">(</span><span class="n">fin</span> <span class="n">n</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span>    <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="p">(</span><span class="o">!!</span><span class="p">)</span>       <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span> <span class="n">m</span> <span class="n">i</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">n</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="n">a</span>


 <span class="o">//</span> <span class="kt">Abbreviations</span>
 <span class="n">splitBy</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">split</span><span class="p">`{</span><span class="n">parts</span> <span class="ow">=</span> <span class="n">n</span><span class="p">}</span>
 <span class="n">groupBy</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">split</span><span class="p">`{</span><span class="n">each</span>  <span class="ow">=</span> <span class="n">n</span><span class="p">}</span>
 <span class="n">tail</span> <span class="n">n</span>    <span class="ow">=</span> <span class="n">splitAt</span><span class="p">`{</span><span class="n">front</span> <span class="ow">=</span> <span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="mi">2</span>
 <span class="n">take</span> <span class="n">n</span>    <span class="ow">=</span> <span class="n">splitAt</span><span class="p">`{</span><span class="n">front</span> <span class="ow">=</span> <span class="n">n</span><span class="p">}</span><span class="o">.</span><span class="mi">1</span>
 <span class="n">drop</span> <span class="n">n</span>    <span class="ow">=</span> <span class="n">splitAt</span><span class="p">`{</span><span class="n">front</span> <span class="ow">=</span> <span class="n">n</span><span class="p">}</span><span class="o">.</span><span class="mi">2</span>

 <span class="o">/*</span> <span class="kt">Also</span><span class="p">,</span> <span class="p">`</span><span class="n">length</span><span class="p">`</span> <span class="n">is</span> <span class="n">not</span> <span class="n">really</span> <span class="n">needed</span><span class="kt">:</span>
    <span class="n">length</span> <span class="kt">:</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">}</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;=</span> <span class="n">width</span> <span class="n">n</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span>
    <span class="n">length</span> <span class="kr">_</span> <span class="ow">=</span> <span class="p">`</span><span class="n">n</span>
  <span class="o">*/</span>
</code></pre></figure>
<h2 id="shift-and-rotate">Shift And Rotate</h2>
<figure class="codeblock"><pre><code class="highlight language-haskell"> <span class="p">(</span><span class="o">&lt;&lt;</span><span class="p">)</span>   <span class="kt">:</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">n</span><span class="p">,</span> <span class="kt">Logic</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span>
 <span class="p">(</span><span class="o">&gt;&gt;</span><span class="p">)</span>   <span class="kt">:</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">n</span><span class="p">,</span> <span class="kt">Logic</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span>
 <span class="p">(</span><span class="o">&lt;&lt;&lt;</span><span class="p">)</span>  <span class="kt">:</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">n</span><span class="p">,</span> <span class="kt">Logic</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span>
 <span class="p">(</span><span class="o">&gt;&gt;&gt;</span><span class="p">)</span>  <span class="kt">:</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">n</span><span class="p">,</span> <span class="kt">Logic</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span>
</code></pre></figure>
<h2 id="random-values">Random Values</h2>
<p>New types:</p>
<figure class="codeblock"><pre><code class="highlight language-haskell"> <span class="n">random</span>    <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="n">a</span>
</code></pre></figure>
<h2 id="debugging">Debugging</h2>
<figure class="codeblock"><pre><code class="highlight language-haskell"> <span class="kt">ASSERT</span>      <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="kt">Bit</span><span class="p">,[</span><span class="n">n</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span><span class="n">a</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="n">undefined</span>   <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="n">a</span>
 <span class="ne">error</span>       <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span><span class="p">}</span> <span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="n">trace</span>       <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span> <span class="n">j</span><span class="p">}</span> <span class="p">([</span><span class="n">n</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span><span class="n">a</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">j</span>
</code></pre></figure>
<h2 id="hints-for-hardware-generation">Hints for Hardware Generation?</h2>
<figure class="codeblock"><pre><code class="highlight language-haskell"> <span class="n">pipeline_stop</span> <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="n">pipeline</span>      <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span><span class="p">}</span> <span class="p">(</span><span class="n">fin</span> <span class="n">n</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">([</span><span class="n">n</span><span class="p">],</span><span class="n">a</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">a</span>

 <span class="n">seq</span>           <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span><span class="p">}</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span>
 <span class="n">par</span>           <span class="kt">:</span> <span class="p">{</span><span class="n">n</span> <span class="n">a</span><span class="p">}</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="n">a</span>
 <span class="n">reg</span>           <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
 <span class="n">const</span>         <span class="kt">:</span> <span class="p">{</span><span class="n">a</span><span class="p">}</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">a</span>
</code></pre></figure>
<h2 id="closing-remarks">Closing Remarks</h2>
<div class="callout">
<strong>Remark</strong>: If you have ever used Cryptol 1 you will notice there are some differences in the type-signatures.
</div></div>
  <div class="meta">
    <div class="meta-component"><i class="fa fa-calendar fa-fw"></i> May  4, 2014</div>
    <div class="meta-component"><i class="fa fa-code-fork fa-fw"></i> <a href="https://github.com/victoredwardocallaghan/victoredwardocallagan.github.io/commits/source/provider/notes/cryptol-primitives.markdown">History</a><span class="hash">, <a href="https://github.com/victoredwardocallaghan/victoredwardocallagan.github.io/commit/f76d258" title="Initial customise">f76d258</a></span></div>
    <div class="meta-component"><i class="fa fa-pencil fa-fw"></i> <a href="..">Notes</a></div>
  </div>
</article>
<section id="comment">
  <div id="disqus_thread" aria-live="polite">
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>



    </div>
    <footer id="footer" class="inner">
      <div id="social">
        <a href="https://github.com/victoredwardocallaghan" title="github"><i class="fa fa-github-alt"></i></a>
        &middot;
        <a href="http://stackoverflow.com/users/xxxyyy/funfunctor" title="stackoverflow"><i class="fa fa-stack-overflow"></i></a>
        &middot;
        <a href="mailto:eocallaghan@alterapraxis.com" title="email"><i class="fa fa-envelope"></i></a>
        &middot;
        <a href="/atom.xml" title="feed"><i class="fa fa-rss-square"></i></a>
      </div>
    </footer>
    
    <!-- disqus -->
<script async="true" type="text/javascript">
  var disqus_shortname = 'blaenkdenum';
  var disqus_identifier = 'http://blaenkdenum.com/notes/cryptol-primitives/';
  var disqus_url = 'http://blaenkdenum.com/notes/cryptol-primitives/';
  var disqus_script = 'embed.js';

  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());

  jQuery(function (){
    jQuery(window).bind('orientationchange', function() {
      DISQUS.reset({
        reload: true,
        config: function() {
          this.page.identifier = 'http://blaenkdenum.com/notes/cryptol-primitives/'
          this.page.url = 'http://blaenkdenum.com/notes/cryptol-primitives/'
        }
      });
    });
  });
</script>

    <!--MathJax CDN-->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        messageStyle: "none"
      });

      MathJax.Hub.Register.MessageHook('End Process', function() {
        jQuery('#MathJax_Font_Test').empty();
        jQuery('.MathJax_Display').parent('.math').addClass('mobile-math');
      });
    </script>
    <script async="true" type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
    </script>
  </div>
</body>
</html>
